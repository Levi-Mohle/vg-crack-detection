# @package _global_

# to execute this experiment run:
# python train.py experiment=example

defaults:
  - override /data: impasto
  - override /model: cddpm
  - override /callbacks: default
  - override /trainer: default

# all parameters below will be merged with parameters from default configurations set above
# this allows you to overwrite only specified parameters

tags: ["impasto", "denoising diffusion"]

seed: 12345

callbacks:
    early_stopping:
        monitor: "val/loss"
        patience: 15
        mode: "min"
    model_summary:
      max_depth: 1
    model_checkpoint:
        mode: "min"
        monitor: "val/loss"

model:
    criterion:
      _target_: src.models.components.loss_functions.losses.MSE_loss
    unet_dict: 
      # ckpt_path: '/data/storage_crack_detection/lightning-hydra-template/logs/train/runs/2024-12-09_10-43-10_DDPM_1000steps/checkpoints/last.ckpt'
      ckpt_path: '/data/storage_crack_detection/lightning-hydra-template/logs/train/runs/2024-12-02_12-46-26_DDPM_1000steps/checkpoints/last.ckpt'
      num_condition_steps: 200
      condition_weight: 3
      skip: 25
      eta: 1
    fe_dict:
      v: 10
      ckpt_path: '/data/storage_crack_detection/lightning-hydra-template/logs/train/runs/2024-12-11_10-47-05_FE_DDIM/checkpoints/epoch_002.ckpt'
      use_DDIM: true
      use_FE: true
      layer: [0,1]
    target: 2
    
trainer:
  min_epochs: 5
  max_epochs: 30
  enable_model_summary: false
  gradient_clip_val: 0.5

data:
  batch_size: 32
  rgb_transform:
    _target_: src.data.components.transforms.diffuser_normalize
  height_transform:
    _target_: src.data.components.transforms.diffuser_normalize_height

extras:
  print_config: false

logger:
  csv:
      prefix: "impasto_ddpm"
  wandb:
    tags: ${tags}
    group: "impasto"
  aim:
    experiment: "impasto"
  mlflow:
    experiment_name: "impasto ddpm"
  tensorboard:
    name: "impasto ddpm"

